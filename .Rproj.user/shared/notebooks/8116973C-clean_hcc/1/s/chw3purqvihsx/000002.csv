"0","getSeason <- function(input.date){"
"0","  numeric.date <- 100*month(input.date)+day(input.date)"
"0","  ## input Seasons upper limits in the form MMDD in the ""break ="" option:"
"0","  cuts <- base::cut(numeric.date, breaks = c(0,319,0620,0921,1220,1231)) "
"0","  # rename the resulting groups (could've been done within cut(...levels=) if ""Winter"" wasn't double"
"0","  levels(cuts) <- c(""Winter"",""Spring"",""Summer"",""Fall"",""Winter"")"
"0","  return(cuts)"
"0","}"
"0",""
"0","mean_gestionational_weeks_birth <- mean(hc$gestational_weeks_birth, na.rm = TRUE)"
"0",""
"0","hc <-"
"0","  hc %>% "
"0","  left_join(hcc_q, by = c(""ID"", ""timepoint"")) %>% "
"0","  mutate("
"0","    seg_week = case_when("
"0","      dyad == ""m"" & timepoint == ""T1"" & segment == 1 ~ weeks_collect_t1,"
"0","      dyad == ""m"" & timepoint == ""T1"" & segment == 2 ~ weeks_collect_t1 - 4,"
"0","      dyad == ""m"" & timepoint == ""T1"" & segment == 3 ~ weeks_collect_t1 - 8,"
"0","      dyad == ""m"" & timepoint == ""T1"" & segment == 4 ~ weeks_collect_t1 - 12,"
"0","      dyad == ""m"" & timepoint == ""T1"" & segment == 5 ~ weeks_collect_t1 - 16,"
"0","      dyad == ""m"" & timepoint == ""T2"" & segment == 1 ~ weeks_collect_t2,"
"0","      dyad == ""m"" & timepoint == ""T2"" & segment == 2 ~ weeks_collect_t2 - 4,"
"0","      dyad == ""m"" & timepoint == ""T2"" & segment == 3 ~ weeks_collect_t2 - 8,"
"0","      dyad == ""m"" & timepoint == ""T2"" & segment == 4 ~ weeks_collect_t2 - 12,"
"0","      dyad == ""m"" & timepoint == ""T2"" & segment == 5 ~ weeks_collect_t2 - 16,"
"0","      dyad == ""m"" & timepoint == ""T3"" & segment == 1 ~ weeks_collect_t3,"
"0","      dyad == ""m"" & timepoint == ""T3"" & segment == 2 ~ weeks_collect_t3 - 4,"
"0","      dyad == ""m"" & timepoint == ""T3"" & segment == 3 ~ weeks_collect_t3 - 8,"
"0","      dyad == ""m"" & timepoint == ""T3"" & segment == 4 ~ weeks_collect_t3 - 12,"
"0","      dyad == ""m"" & timepoint == ""T3"" & segment == 5 ~ weeks_collect_t3 - 16"
"0","    )"
"0","  ) %>% "
"0","  group_by(ID) %>% "
"0","  mutate("
"0","    # recode hair washing frequency so higher scores = more frequent"
"0","    hair_wash_freq = recode("
"0","      hair_wash_freq,"
"0","      ""1"" = 4, # 1 = daily"
"0","      ""2"" = 3, # 2 = every other day"
"0","      ""3"" = 2, # 3 = once a week"
"0","      ""4"" = 1 # 4 = < once a week"
"0","    ),"
"0","    hair_wash_freq_mean = mean(hair_wash_freq, na.rm = TRUE),"
"0","    # season of collection"
"0","    season = as.factor("
"0","      case_when("
"0","        timepoint == ""T1"" ~ getSeason(visit_date_t1),"
"0","        timepoint == ""T2"" ~ getSeason(scan_date_t2),"
"0","        timepoint == ""T3"" ~ getSeason(behav_visit_date_t3),"
"0","      )"
"0","    )"
"0","  ) %>% "
"0","  ungroup()"
