"0","do4_T1T2 <-"
"0","  d %>% "
"0","  select("
"0","    ID, "
"0","    timepoint,"
"0","    hcc_m,"
"0","    segment,"
"0","    seg_week"
"0","  ) %>% "
"0","  filter("
"0","    (segment == 0 & timepoint == ""T1"") |"
"0","    (segment == 3 & timepoint == ""T2"") "
"0","  ) %>% "
"0","  group_by(ID) %>% "
"0","  mutate("
"0","    n = n()"
"0","  ) %>% "
"0","  filter(n == 2) %>% "
"0","  arrange(ID, timepoint) %>% "
"0","  group_by(ID) %>% "
"0","  mutate("
"0","    seg_week_diff = seg_week - lag(seg_week)"
"0","  ) %>% "
"0","  group_by(ID) %>% "
"0","  mutate("
"0","    seg_week_diff = sum(seg_week_diff, na.rm = TRUE)"
"0","  ) %>% "
"0","  filter(seg_week_diff < 3 & seg_week_diff >= -3) %>% "
"0","  select(ID, timepoint, hcc_m) %>% "
"0","  spread(timepoint, hcc_m) %>% "
"0","  rename("
"0","    proximal = T1,"
"0","    distal = T2"
"0","  ) %>% "
"0","  ungroup() "
