"0","do5_T2T3 <-"
"0","  d %>% "
"0","  select("
"0","    ID, "
"0","    timepoint,"
"0","    hcc_m,"
"0","    segment,"
"0","    seg_week"
"0","  ) %>% "
"0","  filter("
"0","    (segment == 0 & timepoint == ""T2"") |"
"0","    (segment == 4 & timepoint == ""T3"") "
"0","  ) %>% "
"0","  group_by(ID) %>% "
"0","  mutate("
"0","    n = n()"
"0","  ) %>% "
"0","  filter(n == 2) %>% "
"0","  arrange(ID, timepoint) %>% "
"0","  group_by(ID) %>% "
"0","  mutate("
"0","    seg_week_diff = seg_week - lag(seg_week)"
"0","  ) %>% "
"0","  group_by(ID) %>% "
"0","  mutate("
"0","    seg_week_diff = sum(seg_week_diff, na.rm = TRUE)"
"0","  ) %>% "
"0","  filter(seg_week_diff < 4 & seg_week_diff >= -4) %>% "
"0","  select(ID, timepoint, hcc_m) %>% "
"0","  spread(timepoint, hcc_m) %>% "
"0","  rename("
"0","    proximal = T2,"
"0","    distal = T3"
"0","  ) %>% "
"0","  ungroup()"
