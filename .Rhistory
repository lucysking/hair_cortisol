mutate(
seg_week_preg = scale(
if_else(
seg_week_cent_birth <= 0, seg_week_cent_birth, 0
)
),
seg_week_post = scale(
if_else(
seg_week_cent_birth > 0, seg_week_cent_birth, 0
)
)
)
xmat_mlm1 <-
pred_mlm1 %>%
mutate(
intercept = 1
) %>%
dplyr::select(
intercept,
seg_week_preg,
seg_week_post
) %>%
as.matrix()
# predicted values
fixed_mlm1 <- summary(mlm1)$coefficients[,"Estimate"]
pred_mlm1$fit <-
xmat_mlm1 %*% fixed_mlm1
# standard errors
pred_mlm1$se <-
xmat_mlm1 %*% acov_mlm1 %*% t(xmat_mlm1) %>%
diag() %>%
sqrt()
# CIs
pred_mlm1 <-
pred_mlm1 %>%
mutate(LL = fit - 2*se, UL = fit + 2*se)
mean_gestation_birth <- format(round(mean(d$gestational_weeks_birth, na.rm = TRUE), 2), nsmall = 2)
sd_gestation_birth <- format(round(sd(d$gestational_weeks_birth, na.rm = TRUE), 2), nsmall = 2)
pred_mlm1 %>%
ggplot(aes(seg_week_cent_birth, fit)) +
geom_ribbon(
aes(ymin = LL, ymax = UL),
fill = "grey80",
alpha = .6
) +
geom_line(size = 2) +
geom_vline(
aes(xintercept = 0),
linetype = "dotted",
size = 1
) +
annotate(
"text",
x = 15,
y = -.35,
size = 5,
colour = "grey45",
label = paste0("Mean[SD] gestational \nweeks = ", mean_gestation_birth , "[", sd_gestation_birth, "]")
) +
geom_curve(
aes(x = 11, y = -.5, xend = 0, yend = -.7),
arrow = arrow(length = unit(0.07, "inches")),
size = 0.2,
colour = "grey65",
curvature = -.3
) +
scale_y_continuous(breaks = seq.int(-1, 1, .25), limits = c(-1, 1)) +
scale_x_continuous(breaks = seq.int(-40, 28, 8), limits = c(-40, 28)) +
theme_pubr() +
theme(
strip.text = element_text(size = 16),
axis.title.y = element_text(size = 20, face = "bold"),
axis.title.x = element_text(size = 20, face = "bold"),
axis.text.y = element_text(size = 16),
axis.text.x = element_text(size = 16),
legend.title = element_text(size = 18),
legend.text = element_text(size = 16),
legend.position = "none"
) +
labs(
x = "Weeks from childbirth",
y = "log(HCC) pg/mg"
)
ggsave(
"~/Box/lucy_king_files/BABIES/hair_cortisol/plots/hcc_piecewise_average.png",
width = 6,
height = 5
)
pred_mlm1 %>%
ggplot(aes(crisys_pc, fit)) +
geom_ribbon(
aes(ymin = LL, ymax = UL),
fill = "grey80",
alpha = .6
) +
geom_line(size = 2) +
geom_point(
data = d,
aes( y= hcc_log_m),
size = .5,
alpha = .3
) +
geom_line(
data = d ,
aes(y = hcc_log_m, group = ID),
size=.2,
alpha=.3
) +
scale_y_continuous(breaks = seq.int(-2, 5, .5)) +
scale_x_continuous(breaks = seq.int(-40, 28, 8), limits = c(-40, 28)) +
theme_pubr() +
theme(
strip.text = element_text(size = 16),
axis.title.y = element_text(size = 20, face = "bold"),
axis.title.x = element_text(size = 20, face = "bold"),
axis.text.y = element_text(size = 16),
axis.text.x = element_text(size = 16),
legend.title = element_text(size = 18),
legend.text = element_text(size = 16),
legend.position = "none"
) +
labs(
x = "Weeks from childbirth",
y = "log(HCC) pg/mg"
)
mlm2 <- lmer(
scale(hcc_log_m) ~
scale(seg_week_preg) +
scale(seg_week_post) +
scale(crisys_mu) +
scale(crisys_pc) +
(scale(seg_week_preg) + scale(seg_week_post) + scale(segment) | ID),
data = d
)
summary(mlm2)
mlm2_parameters <- model_parameters(mlm2)
mlm2_parameters
performance(mlm2)
performance(mlm2)
mlm2_parameters
d %>% filter(gestational_weeks_birth < 35)
d
d %>%
dplyr::select(
ID,
timepoint,
mom_age_t1,
gestational_weeks_birth,
cesd,
crisys,
mom_race,
mom_latinx,
annual_income_t1_txt
)
d %>%
dplyr::select(
ID,
timepoint,
mom_age_t1,
gestational_weeks_birth,
cesd_t1:cesd_t3,
crisys_total_T1:crisys_total_T3,
mom_race,
mom_latinx,
annual_income_t1_txt
) %>%
d$crisys_total_T1
d %>%
dplyr::select(
ID,
timepoint,
mom_age_t1,
gestational_weeks_birth,
cesd_t1:cesd_t3,
crisys_total_T1:crisys_total_T3,
mom_race,
mom_latinx,
annual_income_t1_txt
)
d %>%
dplyr::select(
ID,
timepoint,
mom_age_t1,
gestational_weeks_birth,
cesd_t1:cesd_t3,
crisys_total_T1:crisys_total_T3,
mom_race,
mom_latinx,
annual_income_t1_txt
) %>%
distinct(ID, timepoint, .keep_all = TRUE)
d %>%
dplyr::select(
ID,
timepoint,
mom_age_t1,
gestational_weeks_birth,
cesd_t1:cesd_t3,
crisys_total_T1:crisys_total_T3,
mom_race,
mom_latinx,
annual_income_t1_txt
) %>%
distinct(ID, timepoint, .keep_all = TRUE) %>%
group_by(ID) %>%
mutate(
T1_complete = str_detect(timepoint, "T1")
)
d %>%
dplyr::select(
ID,
timepoint,
mom_age_t1,
gestational_weeks_birth,
cesd_t1:cesd_t3,
crisys_total_T1:crisys_total_T3,
mom_race,
mom_latinx,
annual_income_t1_txt
) %>%
distinct(ID, timepoint, .keep_all = TRUE) %>%
group_by(ID) %>%
mutate(
T2_complete = if_else(timepoint == "T2", TRUE, FALSE),
T3_complete = if_else(timepoint == "T3", TRUE, FALSE)
)
d %>%
dplyr::select(
ID,
timepoint,
mom_age_t1,
gestational_weeks_birth,
cesd_t1:cesd_t3,
crisys_total_T1:crisys_total_T3,
mom_race,
mom_latinx,
annual_income_t1_txt
) %>%
distinct(ID, timepoint, .keep_all = TRUE) %>%
mutate(
T2_complete = if_else(timepoint == "T2", TRUE, FALSE),
T3_complete = if_else(timepoint == "T3", TRUE, FALSE)
)
d %>%
dplyr::select(
ID,
timepoint,
mom_age_t1,
gestational_weeks_birth,
cesd_t1:cesd_t3,
crisys_total_T1:crisys_total_T3,
mom_race,
mom_latinx,
annual_income_t1_txt
) %>%
distinct(ID, timepoint, .keep_all = TRUE) %>%
mutate(
T2_complete = if_else(timepoint == "T2", TRUE, FALSE),
T3_complete = if_else(timepoint == "T3", TRUE, FALSE)
) %>%
group_by(ID) %>%
mutate(
T2_complete = sum(T2_complete),
T3_complete = sum(T3_complete)
)
d %>%
dplyr::select(
ID,
timepoint,
mom_age_t1,
gestational_weeks_birth,
cesd_t1:cesd_t3,
crisys_total_T1:crisys_total_T3,
mom_race,
mom_latinx,
annual_income_t1_txt
) %>%
distinct(ID, timepoint, .keep_all = TRUE) %>%
mutate(
T2_complete = if_else(timepoint == "T2", TRUE, FALSE),
T3_complete = if_else(timepoint == "T3", TRUE, FALSE)
) %>%
group_by(ID) %>%
mutate(
T2_complete = sum(T2_complete),
T3_complete = sum(T3_complete)
) %>%
distinct(ID, .keep_all = TRUE)
d %>%
dplyr::select(
ID,
timepoint,
mom_age_t1,
gestational_weeks_birth,
cesd_t1:cesd_t3,
crisys_total_T1:crisys_total_T3,
mom_race,
mom_latinx,
annual_income_t1_txt
) %>%
distinct(ID, timepoint, .keep_all = TRUE) %>%
mutate(
T2_complete = if_else(timepoint == "T2", TRUE, FALSE),
T3_complete = if_else(timepoint == "T3", TRUE, FALSE)
) %>%
group_by(ID) %>%
mutate(
T2_complete = sum(T2_complete),
T3_complete = sum(T3_complete)
) %>%
distinct(ID, .keep_all = TRUE) %>%
count(T2_complete)
d %>%
dplyr::select(
ID,
timepoint,
mom_age_t1,
gestational_weeks_birth,
cesd_t1:cesd_t3,
crisys_total_T1:crisys_total_T3,
mom_race,
mom_latinx,
annual_income_t1_txt
) %>%
distinct(ID, timepoint, .keep_all = TRUE) %>%
mutate(
T2_complete = if_else(timepoint == "T2", TRUE, FALSE),
T3_complete = if_else(timepoint == "T3", TRUE, FALSE)
) %>%
group_by(ID) %>%
mutate(
T2_complete = sum(T2_complete),
T3_complete = sum(T3_complete)
) %>%
ungroup() %>%
distinct(ID, .keep_all = TRUE) %>%
count(T2_complete)
d %>%
dplyr::select(
ID,
timepoint,
mom_age_t1,
gestational_weeks_birth,
cesd_t1:cesd_t3,
crisys_total_T1:crisys_total_T3,
mom_race,
mom_latinx,
annual_income_t1_txt
) %>%
distinct(ID, timepoint, .keep_all = TRUE) %>%
mutate(
T2_complete = if_else(timepoint == "T2", TRUE, FALSE),
T3_complete = if_else(timepoint == "T3", TRUE, FALSE)
) %>%
group_by(ID) %>%
mutate(
T2_complete = sum(T2_complete),
T3_complete = sum(T3_complete)
) %>%
ungroup() %>%
distinct(ID, .keep_all = TRUE) %>%
count(T3_complete)
d %>%
dplyr::select(
ID,
timepoint,
mom_age_t1,
gestational_weeks_birth,
cesd_t1:cesd_t3,
crisys_total_T1:crisys_total_T3,
mom_race,
mom_latinx,
annual_income_t1_txt
) %>%
distinct(ID, timepoint, .keep_all = TRUE) %>%
mutate(
T2_complete = if_else(timepoint == "T2", TRUE, FALSE),
T3_complete = if_else(timepoint == "T3", TRUE, FALSE)
) %>%
group_by(ID) %>%
mutate(
T2_complete = sum(T2_complete),
T3_complete = sum(T3_complete)
) %>%
ungroup() %>%
distinct(ID, .keep_all = TRUE)
dm <-
d %>%
dplyr::select(
ID,
timepoint,
mom_age_t1,
gestational_weeks_birth,
cesd_t1:cesd_t3,
crisys_total_T1:crisys_total_T3,
mom_race,
mom_latinx,
annual_income_t1_txt
) %>%
distinct(ID, timepoint, .keep_all = TRUE) %>%
mutate(
T2_complete = if_else(timepoint == "T2", TRUE, FALSE),
T3_complete = if_else(timepoint == "T3", TRUE, FALSE)
) %>%
group_by(ID) %>%
mutate(
T2_complete = sum(T2_complete),
T3_complete = sum(T3_complete)
) %>%
ungroup() %>%
distinct(ID, .keep_all = TRUE)
t.test(dm$mom_age_t1, dm$T2_complete)
t.test(dm$gestational_weeks_birth, dm$T2_complete)
t.test(dm$mom_age_t1, dm$T2_complete)
t.test(dm$gestational_weeks_birth, dm$T2_complete)
t.test(dm$mom_age_t1 ~ dm$T2_complete)
t.test(dm$gestational_weeks_birth ~ dm$T2_complete)
t.test(dm$cesd_t1 ~ dm$T2_complete)
t.test(dm$cesd_t2 ~ dm$T2_complete)
t.test(dm$cesd_t3 ~ dm$T2_complete)
t.test(dm$crisys_total_T1 ~ dm$T2_complete)
t.test(dm$crisys_total_T2 ~ dm$T2_complete)
t.test(dm$crisys_total_T3 ~ dm$T2_complete)
dm <-
d %>%
dplyr::select(
ID,
timepoint,
mom_age_t1,
gestational_weeks_birth,
cesd_t1:cesd_t3,
crisys_total_T1:crisys_total_T3,
mom_poc,
mom_latinx,
annual_income_t1_txt
) %>%
distinct(ID, timepoint, .keep_all = TRUE) %>%
mutate(
T2_complete = if_else(timepoint == "T2", TRUE, FALSE),
T3_complete = if_else(timepoint == "T3", TRUE, FALSE)
) %>%
group_by(ID) %>%
mutate(
T2_complete = sum(T2_complete),
T3_complete = sum(T3_complete)
) %>%
ungroup() %>%
distinct(ID, .keep_all = TRUE)
dm <-
d %>%
dplyr::select(
ID,
timepoint,
mom_age_t1,
gestational_weeks_birth,
cesd_t1:cesd_t3,
crisys_total_T1:crisys_total_T3,
mom_race,
mom_latinx,
annual_income_t1_txt
) %>%
distinct(ID, timepoint, .keep_all = TRUE) %>%
mutate(
T2_complete = if_else(timepoint == "T2", TRUE, FALSE),
T3_complete = if_else(timepoint == "T3", TRUE, FALSE)
) %>%
group_by(ID) %>%
mutate(
T2_complete = sum(T2_complete),
T3_complete = sum(T3_complete)
) %>%
ungroup() %>%
distinct(ID, .keep_all = TRUE)
dm
dm <-
d %>%
dplyr::select(
ID,
timepoint,
mom_age_t1,
gestational_weeks_birth,
cesd_t1:cesd_t3,
crisys_total_T1:crisys_total_T3,
mom_race,
mom_latinx,
annual_income_t1_txt
) %>%
distinct(ID, timepoint, .keep_all = TRUE) %>%
mutate(
T2_complete = if_else(timepoint == "T2", TRUE, FALSE),
T3_complete = if_else(timepoint == "T3", TRUE, FALSE),
mom_white = if_else(mom_race == "White", "White", "POC")
) %>%
group_by(ID) %>%
mutate(
T2_complete = sum(T2_complete),
T3_complete = sum(T3_complete)
) %>%
ungroup() %>%
distinct(ID, .keep_all = TRUE)
chisq.test(dm$mom_white ~ dm$T2_complete)
chisq.test(dm$mom_white, dm$T2_complete)
chisq.test(dm$mom_latinx, dm$T2_complete)
t.test(dm$mom_age_t1 ~ dm$T3_complete)
t.test(dm$gestational_weeks_birth ~ dm$T3_complete)
t.test(dm$cesd_t1 ~ dm$T3_complete)
t.test(dm$cesd_t2 ~ dm$T3_complete)
t.test(dm$cesd_t3 ~ dm$T3_complete)
t.test(dm$crisys_total_T1 ~ dm$T3_complete)
t.test(dm$crisys_total_T2 ~ dm$T3_complete)
t.test(dm$crisys_total_T3 ~ dm$T3_complete)
